<html style="height: auto;">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ante Jamnet | Settings</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
    <link rel="stylesheet" href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">
    <link rel="stylesheet" href="dist/css/adminlte.min.css">
    <link rel="stylesheet" href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker.css">
    <link rel="stylesheet" href="plugins/summernote/summernote-bs4.css">
    <link rel="stylesheet" href="plugins/toastr/toastr.min.css">

    <link href="plugins/fontawesome-free/css/font.css" rel="stylesheet">
<body class="sidebar-mini layout-fixed" style="height: auto;">
<div class="wrapper">
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
        <a class="brand-link">
            <img src="dist/img/AdminLTELogo.png" alt="Ante Jamnet Logo" class="brand-image img-circle elevation-3"
                 style="opacity: .8">
            <span class="brand-text font-weight-light">Ante Jamnet</span>
        </a>
        <div class="sidebar os-host os-theme-light os-host-resize-disabled os-host-scrollbar-horizontal-hidden os-host-transition os-host-scrollbar-vertical-hidden">
            <div class="os-resize-observer-host observed">
                <div class="os-resize-observer" style="left: 0px; right: auto;"></div>
                <div class="os-resize-observer"></div>
            </div>
            <div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;">
                <div class="os-resize-observer"></div>
            </div>
            <div class="os-content-glue" style="margin: 0px -8px; width: 249px; height: 857px;"></div>
            <div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;">
                <div class="os-resize-observer"></div>
            </div>
            <div class="os-content-glue" style="margin: 0px -8px; width: 249px; height: 857px;"></div>
            <div class="os-padding">
                <div class="os-viewport os-viewport-native-scrollbars-invisible" style="">
                    <div class="os-content" style="padding: 0px 8px; height: 100%; width: 100%;">
                        <nav class="mt-2">
                            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                                data-accordion="false">

                                <li class="nav-item">
                                    <a href="index.html" class="nav-link">
                                        <i class="nav-icon fas fa-network-wired"></i>
                                        <p>Jamnet Network
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="dashboard.html" class="nav-link">
                                        <i class="nav-icon fas fa-tachometer-alt"></i>
                                        <p>Dashboard</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="settings.html" class="nav-link">
                                        <i class="nav-icon fas fa-cogs"></i>
                                        <p>Ayarlar</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="logs.html" class="nav-link">
                                        <i class="nav-icon fas fa-eye"></i>
                                        <p>Kullanıcı Hareketleri</p>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
            <div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable os-scrollbar-auto-hidden">
                <div class="os-scrollbar-track">
                    <div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px);"></div>
                </div>
            </div>
            <div class="os-scrollbar os-scrollbar-vertical os-scrollbar-unusable os-scrollbar-auto-hidden">
                <div class="os-scrollbar-track">
                    <div class="os-scrollbar-handle" style="height: 100%; transform: translate(0px, 0px);"></div>
                </div>
            </div>
            <div class="os-scrollbar-corner"></div>
        </div>
    </aside>
    <div class="content-wrapper" style="min-height: 1746px;">
        <div class="content-header">
            <button type="button" data-widget="pushmenu" class="btn btn-tool" data-card-widget="remove"><i
                    class="fas fa-bars"></i>
            </button>
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-6">
                        <h1 class="m-0 text-dark">Settings</h1>
                    </div>
                </div>
            </div>
        </div>
        <section class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-4 card-body">
                        <strong>Sistem Adı</strong>
                        <div class="input-group mb-3">
                            <input type="text" id="system_name" class="form-control rounded-0">
                            <span class="input-group-append">
                    <button type="button" class="btn btn-info btn-flat" id="set_hostname">Kaydet</button>
                  </span>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-md-4 card-body">
            <div class="card card-info">
                <div class="card-header">
                    <h3 class="card-title">Veritabanı Ayarları</h3>
                </div>

                    <div class="card-body">
                        <div class="form-group row">
                            <label for="pg_ip" class="col-sm-4 col-form-label">Ip</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control" id="pg_ip" placeholder="Ip">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pg_port" class="col-sm-4 col-form-label">Port</label>
                            <div class="col-sm-6">
                                <input type="number" class="form-control" id="pg_port" placeholder="Port">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pg_username" class="col-sm-4 col-form-label">Kullanıcı Adı</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control" id="pg_username" placeholder="Kullanıcı Adı">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pg_password" class="col-sm-4 col-form-label">Şifre</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control" id="pg_password" placeholder="Şifre">
                            </div>
                        </div>
                    </div>
                    <!-- /.card-body -->
                    <div class="card-footer">
                        <button type="button" id="set_pg_db" class="btn btn-info float-right">Kaydet</button>
                    </div>
            </div>
            </div>
            <div class="col-md-4 card-body">
            <div class="card card-info">
                <div class="card-header">
                    <h3 class="card-title">Ip Ayarları</h3>
                </div>

                    <div class="card-body">
                        <div class="form-group row">
                            <label for="pg_ip" class="col-sm-4 col-form-label">Ip</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control" id="eth_ip" placeholder="Ip">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="pg_port" class="col-sm-4 col-form-label">Gateway</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control" id="eth_gateway" placeholder="Gateway">
                            </div>
                        </div>
                    </div>
                    <!-- /.card-body -->
                    <div class="card-footer">
                        <button type="button" id="set_ip" class="btn btn-info float-right">Kaydet</button>
                    </div>
            </div>
            </div>


            <div class="row" id="jamnet-modules">


            </div>

            <div class="row">

                <div class="col-md-2">
                    <button type="button" class="btn btn-block bg-gradient-danger" id="restart">Yeniden Başlat</button>
                    <button type="button" class="btn btn-block bg-gradient-danger" id="shutdown">Sistemi Kapat</button>

                </div>
            </div>
        </section>
    </div>
    <footer class="main-footer">
        <strong><a href="https://www.antesavunma.com.tr/">Ante Savunma</a>.</strong>
        All rights reserved.
        <div class="float-right d-none d-sm-inline-block">
            <b>Version</b> 1.0.5
        </div>
    </footer>
</div>
<script src="plugins/jquery/jquery.min.js"></script>
<script src="plugins/jquery-ui/jquery-ui.min.js"></script>
<script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="plugins/chart.js/Chart.min.js"></script>
<script src="plugins/sparklines/sparkline.js"></script>
<script src="plugins/jquery-knob/jquery.knob.min.js"></script>
<script src="plugins/moment/moment.min.js"></script>
<script src="plugins/daterangepicker/daterangepicker.js"></script>
<script src="plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
<script src="plugins/summernote/summernote-bs4.min.js"></script>
<script src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
<script src="plugins/toastr/toastr.min.js"></script>

<script>
    $(function () {
        $(document).on("click", '[id^=save_]', function () {
            clicker = this.id.replace("save_", "");
            module_name = $('#module_name_' + clicker).val()
            if ($('#is_active_' + clicker).is(':checked')) {
                is_active = 1;
            } else {
                is_active = 0;
            }
            json_data = '{"token":"'+token+'","action":"save_module","module_id":' + clicker + ',"module_name":"' + module_name + '","is_active":' + is_active + '}';

            $.ajax({
                type: "POST",
                url: "http://"+window.location.hostname+":8000/api/system",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: json_data,
                error: function (data) {
                    toastr.error(data['responseJSON']['data']['message'])
                },
                success: function (data) {

                    if (data['data']['success'] == true) {
                        toastr.success(data['data']['message'])

                    }
                }
            });
        });
    });
    $(document).ready(function () {
        token = sessionStorage.getItem('token')
        if (token == null) {
            window.location.replace("login.html");
            return null;
        } else {
            get_settings();
        }


        function redirect() {
            sessionStorage.removeItem("token");
            window.location.replace("login.html");
        }

        function get_settings() {

            $.ajax({
                type: "GET",
                url: "http://"+window.location.hostname+":8000/api/system",
                error: function (data) {
                    toastr.error(data['responseJSON']['data']['message'])
                },
                success: function (data) {
                    if (data['data']['success'] == true) {
                        $("#system_name").val(data['data']['hostname']);
                        $("#pg_ip").val(data['data']['pg_db']['pg_ip']);
                        $("#pg_port").val(data['data']['pg_db']['pg_port']);
                        $("#pg_username").val(data['data']['pg_db']['pg_username']);
                        $("#pg_password").val(data['data']['pg_db']['pg_password']);
                        $("#jamnet-modules").html(data['data']['modules']);
                        $("#eth_ip").val(data['data']['eth_ip']);
                        $("#eth_gateway").val(data['data']['eth_gateway']);
                        $("btn btn-success").on("click", "p.test", function () {
                            save_module();
                        });
                    }
                }
            });

        }

        $('#set_hostname').click(function () {
            $.ajax({
                type: "POST",
                url: "http://"+window.location.hostname+":8000/api/system",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: '{"token":"'+token+'","action":"hostname","hostname":"' + $('#system_name').val() + '"}',
                error: function (data) {
                    toastr.error(data['responseJSON']['data']['message'])
                },
                success: function (data) {

                    if (data['data']['success'] == true) {
                        toastr.success(data['data']['message'])

                    }
                }
            });
        });

        $('#set_ip').click(function () {
            $.ajax({
                type: "POST",
                url: "http://"+window.location.hostname+":8000/api/system",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: '{"token":"'+token+'","action":"set_ip","eth_ip":"' + $('#eth_ip').val() + '","eth_gateway":"' + $('#eth_gateway').val() + '"}',
                error: function (data) {
                    toastr.error(data['responseJSON']['data']['message'])
                },
                success: function (data) {

                    if (data['data']['success'] == true) {
                        toastr.success(data['data']['message'])

                    }
                }
            });
        });

        $('#set_pg_db').click(function () {
            $.ajax({
                type: "POST",
                url: "http://"+window.location.hostname+":8000/api/system",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: '{"token":"'+token+'","action":"set_pg_db","pg_ip":"' + $('#pg_ip').val() + '","pg_port":"' + $('#pg_port').val() + '","pg_username":"' + $('#pg_username').val() + '","pg_password":"' + $('#pg_password').val() + '"}',
                error: function (data) {
                    toastr.error(data['responseJSON']['data']['message'])
                },
                success: function (data) {

                    if (data['data']['success'] == true) {
                        toastr.success(data['data']['message'])

                    }
                }
            });
        });

        $('#restart').click(function () {
            $.ajax({
                type: "POST",
                url: "http://"+window.location.hostname+":8000/api/system",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: '{"token":"'+token+'","action":"restart"}',
                error: function (data) {
                    toastr.error(data['responseJSON']['data']['message'])
                },
                success: function (data) {

                    if (data['data']['success'] == true) {
                        toastr.success("İşlem Başarılı")
                        setTimeout(redirect, 10000);
                    }
                }
            });
        });

        $('#shutdown').click(function () {
            $.ajax({
                type: "POST",
                url: "http://"+window.location.hostname+":8000/api/system",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: '{"token":"'+token+'","action":"shutdown"}',
                error: function (data) {
                    toastr.error(data['responseJSON']['data']['message'])
                },
                success: function (data) {

                    if (data['data']['success'] == true) {
                        toastr.success("İşlem Başarılı")
                        setTimeout(redirect, 10000);

                    }
                }
            });
        });


    });
</script>
</body>
</html>